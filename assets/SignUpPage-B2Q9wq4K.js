import{l as N,u as A,K as Y,r as C,M as T,W as G,X as n,Y as H,j as e,o as h,N as R,Z as F,O as d,a0 as $,B as z,V as U,v as J,F as ee,S as E,U as se,a1 as re,a2 as ie}from"./index-TTKrRBsV.js";import{C as g}from"./CustomInput-CfXd1HaZ.js";import{C as te,a as V}from"./CustomPhoneInput-Dyz5Xq3R.js";import{c as W,a as c,u as B,o as M,F as t,C as m,b as ne}from"./index.esm-Dv3jW_V-.js";import{S as ae}from"./SignUpPage.styles-Z45kjIAM.js";import{C as oe}from"./index.es-D5aqwRbg.js";import{C as O}from"./index-Chkbatr3.js";import{R as y,C as i}from"./row-Bxwr5CQq.js";import{I as le}from"./index-CRizbU4B.js";import"./index-DNWE43hh.js";import"./Skeleton-Bgqqq5sk.js";import"./index-CB8Qoy1w.js";import"./PlusOutlined-Ba-GwlE8.js";const{Title:K,Text:de}=U,ce=({user_ID:f,signUpData:s,setStep:k})=>{const j=N(),{t:p}=A(),{setAccessToken:S}=Y(),[b,v]=C.useState(Date.now()+18e4),q=W().shape({verification_code:c().required(p("Kod kiritilishi kerak !"))}),x=T({mutationKey:["login"],mutationFn:G,onSuccess:a=>{S(n.get(a,"data.token")),j("/")},onError:a=>{console.log(a)}}),u=T({mutationKey:["verify-email"],mutationFn:H,onSuccess:a=>{x.mutateAsync({username:n.get(s,"username",""),password:n.get(s,"password","")})},onError:a=>{console.log(a)}}),{handleSubmit:o,control:_,getValues:l,formState:{errors:I}}=B({defaultValues:{},resolver:M(q)}),r=a=>{const P={user_id:f,verification_code:Number(n.get(a,"verification_code",""))};u.mutateAsync(P)},w=({hours:a,minutes:P,seconds:D,completed:Z})=>{if(Z)return k("register"),null;const Q=String(P).padStart(2,"0"),X=String(D).padStart(2,"0");return e.jsxs("span",{children:[Q,":",X]})};return e.jsx(e.Fragment,{children:e.jsx(O,{style:{maxWidth:"300px"},children:e.jsxs(y,{gutter:[0,24],children:[e.jsx(i,{span:24,children:e.jsx(h,{align:"center",justify:"center",children:e.jsx("img",{onClick:()=>j("/"),src:R,style:{width:"100px",cursor:"pointer"},alt:""})})}),e.jsx(i,{span:24,children:e.jsxs(h,{align:"center",justify:"center",vertical:!0,children:[e.jsx(K,{level:2,children:p("Tasdiqlash")}),e.jsx(de,{level:5,align:"center",children:F.language==="uz"?e.jsxs(e.Fragment,{children:["Tasdiqlash kodi ",e.jsx("b",{children:n.get(s,"email","")})," ga yuborildi. ",e.jsx("br",{}),"Iltimos tasdiqlash kodini kiriting !"]}):F.language=="en"?e.jsxs(e.Fragment,{children:["Verification code sent to"," ",e.jsx("b",{children:n.get(s,"email","")}),". ",e.jsx("br",{}),"Please enter the verification code!"]}):e.jsxs(e.Fragment,{children:["Код подтверждения отправлен на адрес"," ",e.jsx("b",{children:n.get(s,"email","")}),". ",e.jsx("br",{}),"Пожалуйста, введите проверочный код!"]})})]})}),e.jsx(i,{span:24,children:e.jsx(t,{layout:"vertical",className:"login-form",name:"login-form",size:"large",onFinish:o(r),children:e.jsxs(y,{gutter:[15,15],children:[e.jsx(i,{xs:24,md:24,children:e.jsx(t.Item,{style:{display:"flex",alignItems:"center",justifyContent:"center"},...d(I,"verification_code"),required:!0,children:e.jsx(m,{name:"verification_code",control:_,render:({field:a})=>e.jsx(le.OTP,{...a,length:4,prefix:e.jsx($,{})})})})}),e.jsx(i,{xs:24,md:24,children:e.jsx(t.Item,{style:{marginTop:"20px"},children:e.jsx(z,{style:{width:"100%"},type:"primary",htmlType:"submit",loading:u.isLoading||u.isPending||x.isLoading||x.isPending,disabled:u.isLoading||u.isPending||x.isLoading||x.isPending,children:p("Tasdiqlash")})})})]})})}),e.jsx(i,{span:24,children:e.jsx(h,{align:"center",justify:"center",children:e.jsx(K,{level:5,children:e.jsx(oe,{date:b,renderer:w})})})})]})})})},{Title:me,Text:L}=U,Ie=()=>{const f=N(),{t:s}=A(),[k,j]=C.useState("register"),[p,S]=C.useState(null),b=W().shape({comp_name:c().required(s("Korxona nomi kiritilishi kerak !")),currency_type:c().required(s("Valyuta kiritilishi kerak !")),first_name:c().required(s("Ism kiritilishi kerak !")),last_name:c().required(s("Familiya kiritilishi kerak !")),email:c().email(s("Email to'g'ri formatda bo'lishi kerak !")).required(s("Email kiritilishi kerak !")),username:c().required(s("Telefon raqam kiritilishi kerak !")),password:c().required(s("Parol kiritilishi kerak !")),password2:c().oneOf([ne("password"),null],s("Parollar mos kelishi kerak")).required(s("Parolni qayta kiriting"))}),v=T({mutationKey:["sign-up"],mutationFn:re,onSuccess:r=>{ie(s("Emailga tasdiqlash kodi yuborildi !")),j("verify"),S(r.data.user_id)},onError:r=>{console.log(r)}}),{mutateAsync:q,isPending:x}=v,{handleSubmit:u,control:o,getValues:_,formState:{errors:l}}=B({defaultValues:{phone:"",password:""},resolver:M(b)}),I=r=>{const w={company:{comp_name:n.get(r,"comp_name",""),tariff:"BEST",currency_type:n.get(r,"currency_type","UZS")},user:{username:n.get(r,"username",""),first_name:n.get(r,"first_name",""),last_name:n.get(r,"last_name",""),email:n.get(r,"email",""),password:n.get(r,"password","")}};q(w)};return e.jsx(ae,{children:k==="verify"?e.jsx(ce,{user_ID:p,signUpData:_(),setStep:j}):e.jsx(O,{style:{maxWidth:"600px"},children:e.jsxs(y,{gutter:[0,24],children:[e.jsx(i,{span:24,children:e.jsx(h,{align:"center",justify:"center",children:e.jsx("img",{onClick:()=>f("/"),src:R,style:{width:"100px",cursor:"pointer"},alt:""})})}),e.jsx(i,{span:24,children:e.jsxs(h,{align:"center",justify:"center",vertical:!0,children:[e.jsx(me,{level:2,children:s("Ro'yxatdan o'tish")}),e.jsx(L,{children:s("Iltimos, ro'yxatdan o'tish uchun ma'lumotlaringizni kiriting.")})]})}),e.jsx(i,{span:24,children:e.jsx(t,{layout:"vertical",className:"login-form",name:"login-form",size:"large",onFinish:u(I),children:e.jsxs(y,{gutter:[15,15],children:[e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Korxona nomi"),...d(l,"comp_name"),required:!0,children:e.jsx(m,{name:"comp_name",control:o,render:({field:r})=>e.jsx(g,{...r,prefix:e.jsx($,{})})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Valyuta turi"),...d(l,"currency_type"),required:!0,children:e.jsx(m,{name:"currency_type",control:o,render:({field:r})=>e.jsx(g,{...r,prefix:e.jsx(J,{})})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Ism"),...d(l,"first_name"),required:!0,children:e.jsx(m,{name:"first_name",control:o,render:({field:r})=>e.jsx(g,{...r})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Familiya"),...d(l,"last_name"),required:!0,children:e.jsx(m,{name:"last_name",control:o,render:({field:r})=>e.jsx(g,{...r})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Email"),...d(l,"email"),required:!0,children:e.jsx(m,{name:"email",control:o,render:({field:r})=>e.jsx(g,{...r,prefix:e.jsx(ee,{})})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Telefon raqam"),...d(l,"username"),required:!0,children:e.jsx(m,{name:"username",control:o,render:({field:r})=>e.jsx(te,{...r})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Parol"),...d(l,"password"),required:!0,children:e.jsx(m,{name:"password",control:o,render:({field:r})=>e.jsx(V,{...r,placeholder:s("Parolni kiriting"),prefix:e.jsx(E,{})})})})}),e.jsx(i,{xs:24,md:12,children:e.jsx(t.Item,{label:s("Parolni tasdiqlang"),...d(l,"password2"),required:!0,children:e.jsx(m,{name:"password2",control:o,render:({field:r})=>e.jsx(V,{...r,placeholder:s("Parolni qayta kiriting"),prefix:e.jsx(E,{})})})})}),e.jsx(i,{xs:24,md:24,children:e.jsx(t.Item,{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(z,{style:{minWidth:"300px",marginTop:"10px"},type:"primary",htmlType:"submit",loading:x,disabled:x,children:s("Ro'yxatdan o'tish")})})}),e.jsx(i,{xs:24,md:24,children:e.jsx(t.Item,{children:e.jsx(h,{align:"center",justify:"center",children:e.jsxs(L,{children:[e.jsxs("span",{style:{marginRight:"5px"},children:[s("Akkauntingiz bo'lsa"),":"]}),e.jsx(se,{to:"/auth/sign-in",children:s("Kirish")})]})})})})]})})})]})})})};export{Ie as default};
